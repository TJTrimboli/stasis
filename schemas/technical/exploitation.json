{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://utamf.org/schemas/technical/exploitation.json",
    "title": "UTAMF Exploitation Methods",
    "description": "Exploitation techniques and capabilities",
    "type": "object",
    "properties": {
        "techniques": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "Zero-day",
                            "Known Vulnerability",
                            "Social Engineering",
                            "Password Spraying",
                            "Brute Force",
                            "Supply Chain",
                            "Other"
                        ]
                    },
                    "cve_id": {
                        "type": "string",
                        "pattern": "^CVE-[0-9]{4}-[0-9]{4,}$"
                    },
                    "first_seen": {
                        "$ref": "../common/timestamp.json"
                    },
                    "last_seen": {
                        "$ref": "../common/timestamp.json"
                    },
                    "effectiveness": {
                        "type": "string",
                        "enum": ["Low", "Medium", "High"]
                    },
                    "mitre_technique_id": {
                        "type": "string",
                        "pattern": "^T\d{4,}(?:\.\d+)?$"
                    }
                },
                "required": ["name", "type"]
            }
        },
        "exploit_development": {
            "type": "object",
            "properties": {
                "capability": {
                    "type": "string",
                    "enum": ["None", "Limited", "Moderate", "Advanced"]
                },
                "known_developers": {
                    "type": "integer",
                    "minimum": 0
                },
                "development_speed": {
                    "type": "string",
                    "enum": ["Slow", "Moderate", "Rapid"]
                }
            }
        },
        "zero_day_usage": {
            "type": "object",
            "properties": {
                "frequency": {
                    "type": "string",
                    "enum": ["Never", "Rare", "Occasional", "Frequent"]
                },
                "last_observed": {
                    "$ref": "../common/timestamp.json"
                },
                "target_selection": {
                    "type": "string",
                    "description": "Strategy for deploying zero-days"
                }
            }
        },
        "exploit_chains": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "steps": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "order": {
                                    "type": "integer",
                                    "minimum": 1
                                },
                                "technique": {
                                    "type": "string"
                                },
                                "purpose": {
                                    "type": "string"
                                }
                            },
                            "required": ["order", "technique"]
                        }
                    },
                    "effectiveness": {
                        "type": "string",
                        "enum": ["Low", "Medium", "High"]
                    }
                },
                "required": ["name", "steps"]
            }
        },
        "target_platforms": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "type": {
                        "type": "string",
                        "enum": [
                            "Windows",
                            "Linux",
                            "macOS",
                            "Android",
                            "iOS",
                            "Network Device",
                            "IoT",
                            "Industrial Control System",
                            "Other"
                        ]
                    },
                    "versions": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "Specific versions or variants targeted"
                    },
                    "prevalence": {
                        "type": "string",
                        "enum": ["Low", "Medium", "High"],
                        "description": "How frequently this platform is targeted"
                    }
                },
                "required": ["type"]
            }
        },
        "weaponization": {
            "type": "object",
            "properties": {
                "capability": {
                    "type": "string",
                    "enum": ["None", "Limited", "Moderate", "Advanced"]
                },
                "delivery_methods": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "method": {
                                "type": "string",
                                "enum": [
                                    "Phishing",
                                    "Watering Hole",
                                    "USB",
                                    "Supply Chain",
                                    "Direct Download",
                                    "Other"
                                ]
                            },
                            "prevalence": {
                                "type": "string",
                                "enum": ["Low", "Medium", "High"]
                            },
                            "details": {
                                "type": "string"
                            }
                        },
                        "required": ["method"]
                    }
                },
                "packaging": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "Executable",
                            "Document",
                            "Script",
                            "Archive",
                            "Dropper",
                            "Other"
                        ]
                    }
                }
            }
        },
        "post_exploitation": {
            "type": "object",
            "properties": {
                "capabilities": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": [
                            "Privilege Escalation",
                            "Credential Theft",
                            "Lateral Movement",
                            "Data Discovery",
                            "Persistence",
                            "Defense Evasion"
                        ]
                    }
                },
                "tools": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "name": {
                                "type": "string"
                            },
                            "type": {
                                "type": "string",
                                "enum": [
                                    "Custom",
                                    "Open Source",
                                    "Commercial",
                                    "Modified"
                                ]
                            },
                            "purpose": {
                                "type": "string"
                            }
                        },
                        "required": ["name", "type"]
                    }
                }
            }
        },
        "operational_sophistication": {
            "type": "object",
            "properties": {
                "level": {
                    "type": "string",
                    "enum": ["Low", "Medium", "High"]
                },
                "characteristics": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "improvement_trend": {
                    "type": "string",
                    "enum": ["Declining", "Stable", "Improving"]
                }
            }
        }
    },
    "required": ["techniques"],
    "additionalProperties": false
}